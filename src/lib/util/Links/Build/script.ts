import { readFileSync, writeFileSync } from 'fs';
import { toUnicode } from 'punycode';
import { join } from 'path';

const source = readFileSync(join(__dirname, 'source.txt'), 'utf8').trim().split('\n');
const header = `// Autogenerated file from ICANN, source:\n// http://data.iana.org/TLD/tlds-alpha-by-domain.txt\n\nexport const TLDs = [\n`;
const footer = '\n];\n';
const content = source.map((line, index) => {
	const lLine = line.toLowerCase();
	const parsed = toUnicode(lLine);
	const delimiter = index === source.length - 1 ? '' : ',';
	return lLine === parsed ? `\t'${parsed}'${delimiter}` : `\t'${parsed}'${delimiter} // ${lLine}`;
}).join('\n');

writeFileSync(join(__dirname, '..', 'TLDs.ts'), header + content + footer);
